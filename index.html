<!DOCTYPE html>
<html>
  <head>
    <title>House</title>
    <script src="https://aframe.io/releases/0.7.1/aframe.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles.css" />
  </head>
  <body class="background" onload="changeText()">
    <script src="script.js"></script>

    <div class="map map-container">
      <img src="Assets/map.jpg" alt="map" class="map-image">
    </div>


    <div class="house box-construct">
      <button id="button">Change House View</button>

      <a-scene embedded>
        <a-assets>
          <a-asset-item id="blank" src="Assets/blank.glb"></a-asset-item>
          <a-asset-item id="front" src="Assets/front.glb"></a-asset-item>
          <a-asset-item id="back" src="Assets/back.glb"></a-asset-item>
          <a-asset-item id="left" src="Assets/left.glb"></a-asset-item>
          <a-asset-item id="right" src="Assets/right.glb"></a-asset-item>
          <a-asset-item id="top" src="Assets/top.glb"></a-asset-item>
        </a-assets>

        <!-- Original 2d house -->
        <a-entity click-to-replace id="back" gltf-model="#blank" position="0 2.35 -1.5" visible="true"></a-entity>
        <a-entity click-to-replace id="left" gltf-model="#blank" position="-0.54 1.85 -1.5" visible="true"></a-entity>
        <a-entity click-to-replace id="right" gltf-model="#blank" position="0.54 1.85 -1.5" visible="true"></a-entity>
        <a-entity click-to-replace id="front" gltf-model="#blank" position="0 1.35 -1.5" visible="true"></a-entity>
        <a-entity click-to-replace id="top" gltf-model="#blank" position="0 0.85 -1.5" visible="true"></a-entity>
        <a-entity click-to-replace id="bottom" gltf-model="#blank" position="0 1.85 -1.5" visible="true"></a-entity>

        <a-entity id="solution" gltf-model="#solution" position="0 1 -2" drag-rotate-component visible="false"></a-entity>
        <a-entity cursor="rayOrigin:mouse"></a-entity>
        <a-camera position="0 0 0" look-controls="enabled:false"></a-camera>

      </a-scene>
      <script type="text/javascript">
        document.getElementById("button").addEventListener("click", () => {
          console.log("clicked");
          document.getElementById("solution").setAttribute("visible", true);
          document.getElementById("back").setAttribute("visible", false);
          document.getElementById("front").setAttribute("visible", false);
          document.getElementById("left").setAttribute("visible", false);
          document.getElementById("right").setAttribute("visible", false);
          document.getElementById("top").setAttribute("visible", false);
          document.getElementById("bottom").setAttribute("visible", false);
        })
      </script>
    </div>

<div class="textbox">
  <button class="map go-button" type="button" onclick="showHouse(); changeText()"><b>Go</b></button>
  <button id="next" class="house dialogue-button" type="button" onclick="changeText()"><b>&#8594</b></button>

  <!-- <script>
    // document.getElementById("next").addEventListener("click", changeText());
    document.getElementById("next").addEventListener("click", () => { console.log("clicked")});
  </script> -->

  <p id="dialogue">Hello! We're having some technical difficulties.</p>
  <p id="map" class="hiddenText"><b>Whiskers</b><br><br>Hi there! I'm Whiskers Fluffikins and this is my brother Mister Fluffikins.
    We just moved here! Our great uncle's mother's daughter's second cousin twice removed recently passed and left us a plot of land. 
    A friendly local already marked our map â€” see that red 'X'? That's where the land is. 
    Unfortunately, all these one-way streets are giving us a headache. 
    Could you please help us get there?</p>

  <p id="house0" class="hiddenText">(You arrive at an empty plot of land with Whiskers and Mister Fluffikins.)</p>
  <p id="house1" class="hiddenText"><b>Whiskers</b><br><br>Thank you so much for helping out! Can we get your help once more? See, we 
    would really love to build our dream house here! This is what it looks like!</p>
  <!-- show completed house model -->

  <p id="house-choice1" class="hiddenText"><b>Whiskers</b><br><br>Could you help us build our house?</p>
  <p id="choice1-1" class="hiddenText"><b>You</b><br><br>But I already helped you.</p><br>
  <p id="choice1-2" class="hiddenText">Absolutely!</p><br>
  <p id="choice1-3" class="hiddenText">I, uh, think I left the oven on.</p>
  <p id="choice1-1-response" class="hiddenText"><b>Whiskers</b><br><br>Don't worry! We just need a third person to help guide us with 
    the blueprint. We'll do all the heavy lifting, promise! Please help us?</p>
  <!-- loop back to instr-choice1 -->
  <p id="choice1-3-response" class="hiddenText"><b>Mister</b><br><br>Hm? But weren't you already out and about when we ran into you?</p>
  <!-- loop back to instr-choice1 -->

  <p id="instr" class="hiddenText">Interact with the finished house to find the feature that the Fluffikins 
    want, then click on the blueprint where you think it should be placed.</p>
  <p id="house2" class="hiddenText"><b>Mister</b><br>This is the house blueprint. Can you help us place the front door first? Whiskers 
    wants it in pink, it's driving me crazy.</p>
  <!-- user places front door -->
  <p id="house3" class="hiddenText"><b>Whiskers</b><br><br>Great! Now we need a back door. My brother insists that it must be black.</p>
  <!-- user places back door -->
  <p id="house4" class="hiddenText"><b>Mister</b><br><br>We'd also like a window that wraps around the side of the house.</p>
  <!-- user places both window parts -->
  <p id="house5" class="hiddenText"><b>Whiskers</b><br><br>Lovely! Just one last detail. Mister thinks this is just silly, but I think 
    the house would look wonderful with some decorative painting. A large diagonal across one side of the house 
    and up onto the roof should add a little character!</p>
  <!-- user places decoration parts -->
  <!-- blueprint is folded into finished house model -->
  <p id="house6" class="hiddenText"><b>Mister</b><br><br>Wait just a minute. Look at our house! It's all mostly just one color!</p>
  <p id="house7" class="hiddenText"><b>Whiskers</b><br><br>Fish sticks. You have that black back door, brother. And if I do say so
    myself, it sure sticks out like a sore thumb! This is why I wanted it in lavendar.</p>

  <p id="house-choice2" class="hiddenText"><b>Whiskers and Mister</b><br><br>What do you think?</p>
  <p id="choice2-1" class="hiddenText"><b>You</b><br><br>Mister is right, a house all in one color is weird!</p><br>
  <p id="choice2-2" class="hiddenText">Whiskers is right.</p>
  <p id="choice2-3" class="hiddenText">It doesn't have to be one or the other.</p>
  <p id="choice2-1-response" class="hiddenText"><b>Mister</b><br><br>Exactly! Wait, but it's not all one color.</p>
  <!-- loop back to house-choice2 -->
  <p id="choice2-2-response" class="hiddenText"><b>Whiskers</b><br><br>Exactly! But why do you think I'm right?</p>
  <!-- loop back to house-choice2 -->

  <p id="house8" class="hiddenText"><b>You</b><br><br>You can paint the door or even the whole house to be a different color! 
    Plus, you can furnish the inside however you want, and it doesn't have to match. As long as you can both 
    be comfortable!</p>
  <p id="house9" class="hiddenText"><b>Mister</b><br><br>Well, that's one thing I know my sister and I can both agree on. Comfort is key!</p>
  <p id="house10" class="hiddenText"><b>Whiskers</b><br><br>And since we built this house together, we both know what went into making it. 
    I can certainly rest easier knowing that it's a product of both our hard work!</p>
  <p id="house11" class="hiddenText"><b>Whiskers and Mister</b><br><br>And thank YOU, for helping us build our house and sorting out 
    our sibling quarrels!</p>

   <!-- <p id=""><b>name</b><br><br>text</p> -->

</div>

<script>
    function changeText() {
      /* Dialogue button doesn't work :( */
      if (document.getElementById("dialogue").innerHTML == "Hello! We're having some technical difficulties.") {
        document.getElementById("dialogue").innerHTML = document.getElementById("map").innerHTML;
      } else if (document.getElementById("dialogue").innerHTML = document.getElementById("map").innerHTML) {
        document.getElementById("dialogue").innerHTML = document.getElementById("house0").innerHTML;
      } else if (document.getElementById("dialogue").innerHTML = document.getElementById("house0").innerHTML) {
        document.getElementById("dialogue").innerHTML = document.getElementById("house1").innerHTML;
      } else if (document.getElementById("dialogue").innerHTML = document.getElementById("house1").innerHTML) {
        document.getElementById("dialogue").innerHTML = document.getElementById("house1-choice").innerHTML;
      }

      document.getElementById("next").addEventListener("click", () => { console.log("clicked")});
  }

  // function changeText() {
  //   var currentText = document.getElementById("dialogue");
  //   if (document.getElementById("dialogue").innerHTML == "Hello! We're having some technical difficulties. Try reloading the page!") {
  //     currentText.innerHTML = document.getElementById("map").innerHTML;
  //   } else {
  //     // match dialogue text, get the element with matching test, get next element, set text
  //     for (const e of document.getElementByClass("textbox")) {
  //       if (e.innerHTML = document.getElementById("dialogue").innerHTML) {
  //         currentText.innerHTML = e.nextElementSibling.innerHTML;
  //       }
  //     }
  //   }
  // }
</script>

<script>
  function showHouse() {
    for (const e of document.getElementsByClassName("house")) {
      e.style.visibility="visible";
    }
    for (const e of document.getElementsByClassName("house-solution")) {
      e.style.visibility="visible";
    }
    for (const e of document.getElementsByClassName("map")) {
      e.style.display="none";
    }
  }
</script>

  </body>
</html>